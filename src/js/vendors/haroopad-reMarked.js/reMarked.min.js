reMarked=function(opts){function extend(a,b){if(!b)return a;for(var c in a)"Object"==typeOf(b[c])?extend(a[c],b[c]):"undefined"!=typeof b[c]&&(a[c]=b[c])}function typeOf(a){return Object.prototype.toString.call(a).slice(8,-1)}function rep(a,b){for(var c="";b-- >0;)c+=a;return c}function trim12(a){for(var a=a.replace(/^\s\s*/,""),b=/\s/,c=a.length;b.test(a.charAt(--c)););return a.slice(0,c+1)}function lpad(a,b,c){return rep(b,c-a.length)+a}function rpad(a,b,c){return a+rep(b,c-a.length)}function otag(a,b){if(!a)return"";for(var c,d="<"+a,e=0;e<b.attributes.length;e++)c=b.attributes.item(e),d+=" "+c.nodeName+'="'+c.nodeValue+'"';return d+">"}function ctag(a){return a?"</"+a+">":""}function pfxLines(a,b){return a.replace(/^/gm,b)}function nodeName(a){return("#text"==a.nodeName?"txt":a.nodeName).toLowerCase()}function wrap(a,b){var c,d;return b instanceof Array?(c=b[0],d=b[1]):c=d=b,c=c instanceof Function?c.call(this,a):c,d=d instanceof Function?d.call(this,a):d,c+a+d}function outerHTML(a){return a.outerHTML||function(a){var b,c=document.createElement("div");return c.appendChild(a.cloneNode(!0)),b=c.innerHTML,c=null,b}(a)}var links=[],cfg={link_list:!1,h1_setext:!0,h2_setext:!0,h_atx_suf:!1,gfm_code:["```","~~~"][0],trim_code:!0,li_bullet:"*-+"[0],hr_char:"-_*"[0],indnt_str:["    ","	","  "][0],bold_char:"*_"[0],emph_char:"*_"[1],gfm_del:!0,gfm_tbls:!0,tbl_edges:!1,hash_lnks:!1,br_only:!1,col_pre:"col ",nbsp_spc:!1,span_tags:!0,div_tags:!0,unsup_tags:{ignore:"script style noscript",inline:"span sup sub i u b center big",block2:"div form fieldset dl header footer address article aside figure hgroup section",block1c:"dt dd caption legend figcaption output",block2c:"canvas audio video iframe"},tag_remap:{i:"em",b:"strong"}},isIE=eval("/*@cc_on!@*/!1"),docMode=document.documentMode,ieLt9=isIE&&(!docMode||9>docMode),textContProp="textContent"in Element.prototype||!ieLt9?"textContent":"innerText";extend(cfg,opts),this.render=function(a){links=[];var b=document.createElement("div");b.innerHTML="string"==typeof a?a:outerHTML(a);var c=new lib.tag(b,null,0),d=c.rend().replace(/^[\t ]+[\n\r]+/gm,"\n").replace(/^[\n\r]+|[\n\r]+$/g,"");if(cfg.link_list&&links.length>0){d+="\n\n";for(var e=0,f=0;f<links.length;f++)if(links[f].e.title){var g=links[f].e.href.length;g&&g>e&&(e=g)}for(var h=0;h<links.length;h++){var i=links[h].e.title?rep(" ",e+2-links[h].e.href.length)+'"'+links[h].e.title+'"':"";d+="  ["+(+h+1)+"]: "+("a"==nodeName(links[h].e)?links[h].e.href:links[h].e.src)+i+"\n"}}return d.replace(/^[\t ]+\n/gm,"\n")};var lib={};lib.tag=klass({wrap:"",lnPfx:"",lnInd:0,init:function(a,b,c){this.e=a,this.p=b,this.i=c,this.c=[],this.tag=nodeName(a),this.initK()},initK:function(){var a;if(this.e.hasChildNodes()){var b,c,d=cfg.unsup_tags.inline;if("table"==nodeName(this.e)&&this.e.hasChildNodes()&&!this.e.tHead){var e=document.createElement("thead"),f=this.e.tBodies[0],g=f.rows[0],h=g.cells[0];if("th"==nodeName(h))e.appendChild(g);else for(var i,a=0,j=g.cells.length,k=e.insertRow();a++<j;)i=document.createElement("th"),i[textContProp]=cfg.col_pre+a,k.appendChild(i);this.e.insertBefore(e,f)}for(a in this.e.childNodes)if(/\d+/.test(a)&&(b=this.e.childNodes[a],c=nodeName(b),c in cfg.tag_remap&&(c=cfg.tag_remap[c]),!cfg.unsup_tags.ignore.test(c))){if("txt"==c&&!nodeName(this.e).match(d)&&/^\s+$/.test(b[textContProp])){if(0==a||a==this.e.childNodes.length-1)continue;var l=this.e.childNodes[a-1],m=this.e.childNodes[a+1];if(l&&!nodeName(l).match(d)||m&&!nodeName(m).match(d))continue}var n=null;if(!lib[c]){var o=cfg.unsup_tags;o.inline.test(c)?c="span"!=c||cfg.span_tags?"tinl":"inl":o.block2.test(c)?c="div"!=c||cfg.div_tags?"tblk":"blk":o.block1c.test(c)?c="ctblk":o.block2c.test(c)?(c="ctblk",n=["\n\n",""]):c="rawhtml"}var p=new lib[c](b,this,this.c.length);n&&(p.wrap=n),(p instanceof lib.a&&b.href||p instanceof lib.img)&&(p.lnkid=links.length,links.push(p)),this.c.push(p)}}},rend:function(){return this.rendK().replace(/\n{3,}/gm,"\n\n")},rendK:function(){for(var a,b="",c=0;c<this.c.length;c++)a=this.c[c],b+=(a.bef||"")+a.rend()+(a.aft||"");return b.replace(/^\n+|\n+$/,"")}}),lib.blk=lib.tag.extend({wrap:["\n\n",""],wrapK:null,tagr:!1,lnInd:null,init:function(a,b,c){this.supr(a,b,c),null===this.lnInd&&(this.p&&this.tagr&&this.c[0]instanceof lib.blk?this.lnInd=4:this.lnInd=0),null===this.wrapK&&(this.tagr&&this.c[0]instanceof lib.blk?this.wrapK="\n":this.wrapK="")},rend:function(){return wrap.call(this,(this.tagr?otag(this.tag,this.e):"")+wrap.call(this,pfxLines(pfxLines(this.rendK(),this.lnPfx),rep(" ",this.lnInd)),this.wrapK)+(this.tagr?ctag(this.tag):""),this.wrap)},rendK:function(){var a=this.supr();if(this.p instanceof lib.li){var b=null,c=a.match(/^[\t ]+/gm);if(!c)return a;for(var d=0;d<c.length;d++)(null===b||c[d][0].length<b.length)&&(b=c[d][0]);return a.replace(new RegExp("^"+b),"")}return a}}),lib.tblk=lib.blk.extend({tagr:!0}),lib.cblk=lib.blk.extend({wrap:["\n",""]}),lib.ctblk=lib.cblk.extend({tagr:!0}),lib.inl=lib.tag.extend({rend:function(){var a=this.rendK(),b=a.match(/^((?: |\t|&nbsp;)*)(.*?)((?: |\t|&nbsp;)*)$/)||[a,"",a,""];return b[1]+wrap.call(this,b[2],this.wrap)+b[3]}}),lib.tinl=lib.inl.extend({tagr:!0,rend:function(){return otag(this.tag,this.e)+wrap.call(this,this.rendK(),this.wrap)+ctag(this.tag)}}),lib.p=lib.blk.extend({rendK:function(){return this.supr().replace(/^\s+/gm,"")}}),lib.list=lib.blk.extend({wrap:[function(){return this.p instanceof lib.li?"\n":"\n\n"},""]}),lib.ul=lib.list.extend({}),lib.ol=lib.list.extend({}),lib.li=lib.cblk.extend({wrap:["\n",function(a){return this.c[0]&&this.c[0]instanceof lib.p||a.match(/\n{2}/gm)?"\n":""}],wrapK:[function(){return"ul"==this.p.tag?cfg.li_bullet+" ":this.i+1+".  "},""],rendK:function(){return this.supr().replace(/\n([^\n])/gm,"\n"+cfg.indnt_str+"$1")}}),lib.hr=lib.blk.extend({wrap:["\n\n",rep(cfg.hr_char,3)]}),lib.h=lib.blk.extend({}),lib.h_setext=lib.h.extend({}),cfg.h1_setext&&(lib.h1=lib.h_setext.extend({wrapK:["",function(a){return"\n"+rep("=",a.length)}]})),cfg.h2_setext&&(lib.h2=lib.h_setext.extend({wrapK:["",function(a){return"\n"+rep("-",a.length)}]})),lib.h_atx=lib.h.extend({wrapK:[function(a){return rep("#",this.tag[1])+" "},function(a){return cfg.h_atx_suf?" "+rep("#",this.tag[1]):""}]}),!cfg.h1_setext&&(lib.h1=lib.h_atx.extend({})),!cfg.h2_setext&&(lib.h2=lib.h_atx.extend({})),lib.h3=lib.h_atx.extend({}),lib.h4=lib.h_atx.extend({}),lib.h5=lib.h_atx.extend({}),lib.h6=lib.h_atx.extend({}),lib.a=lib.inl.extend({lnkid:null,rend:function(){var a=this.rendK(),b=this.e.getAttribute("href"),c=this.e.title?' "'+this.e.title+'"':"";return!this.e.hasAttribute("href")||b==a||"#"==b[0]&&!cfg.hash_lnks?a:cfg.link_list?"["+a+"] ["+(this.lnkid+1)+"]":"["+a+"]("+b+c+")"}}),lib.img=lib.inl.extend({lnkid:null,rend:function(){var a=this.e.alt,b=this.e.getAttribute("src");if(cfg.link_list)return"!["+a+"] ["+(this.lnkid+1)+"]";var c=this.e.title?' "'+this.e.title+'"':"";return"!["+a+"]("+b+c+")"}}),lib.em=lib.inl.extend({wrap:cfg.emph_char}),lib.del=cfg.gfm_del?lib.inl.extend({wrap:"~~"}):lib.tinl.extend(),lib.br=lib.inl.extend({wrap:["",function(){var a=cfg.br_only?"<br>":"  ";return this.p instanceof lib.h?"<br>":a+"\n"}]}),lib.strong=lib.inl.extend({wrap:rep(cfg.bold_char,2)}),lib.blockquote=lib.blk.extend({lnPfx:"> ",rend:function(){return this.supr().replace(/>[ \t]$/gm,">")}}),lib.pre=lib.blk.extend({tagr:!0,wrapK:"\n",lnInd:0}),lib.code=lib.blk.extend({tagr:!1,wrap:"",wrapK:function(a){return-1!==a.indexOf("`")?"``":"`"},lnInd:0,init:function(a,b,c){if(this.supr(a,b,c),this.p instanceof lib.pre)if(this.p.tagr=!1,cfg.gfm_code){var d=this.e.getAttribute("class");d=(d||"").split(" ")[0],0===d.indexOf("lang-")&&(d=d.substr(5)),this.wrapK=[cfg.gfm_code+d+"\n","\n"+cfg.gfm_code]}else this.wrapK="",this.p.lnInd=4},rendK:function(){if(this.p instanceof lib.pre){var a=this.e[textContProp];return cfg.trim_code?a.trim():a}return this.supr()}}),lib.table=cfg.gfm_tbls?lib.blk.extend({cols:[],init:function(a,b,c){this.supr(a,b,c),this.cols=[]},rend:function(){for(var a=0;a<this.c.length;a++)for(var b=0;b<this.c[a].c.length;b++)for(var c=0;c<this.c[a].c[b].c.length;c++)this.c[a].c[b].c[c].prep();return this.supr()}}):lib.tblk.extend(),lib.thead=cfg.gfm_tbls?lib.cblk.extend({wrap:["\n",function(a){for(var b="",c=0;c<this.p.cols.length;c++){var d=this.p.cols[c],e="c"==d.a[0]?":":" ",f="r"==d.a[0]||"c"==d.a[0]?":":" ";b+=(0==c&&cfg.tbl_edges?"|":"")+e+rep("-",d.w)+f+(c<this.p.cols.length-1||cfg.tbl_edges?"|":"")}return"\n"+trim12(b)}]}):lib.ctblk.extend(),lib.tbody=cfg.gfm_tbls?lib.cblk.extend():lib.ctblk.extend(),lib.tfoot=cfg.gfm_tbls?lib.cblk.extend():lib.ctblk.extend(),lib.tr=cfg.gfm_tbls?lib.cblk.extend({wrapK:[cfg.tbl_edges?"| ":"",cfg.tbl_edges?" |":""]}):lib.ctblk.extend(),lib.th=cfg.gfm_tbls?lib.inl.extend({guts:null,wrap:[function(){var a,b=this.p.p.p.cols[this.i],c=0==this.i?"":" ",d=b.w-this.guts.length;switch(b.a[0]){case"r":a=rep(" ",d);break;case"c":a=rep(" ",Math.floor(d/2));break;default:a=""}return c+a},function(){var a,b=this.p.p.p.cols[this.i],c=this.i==this.p.c.length-1?"":" |",d=b.w-this.guts.length;switch(b.a[0]){case"r":a="";break;case"c":a=rep(" ",Math.ceil(d/2));break;default:a=rep(" ",d)}return a+c}],prep:function(){this.guts=this.rendK(),this.rendK=function(){return this.guts};var a=this.p.p.p.cols;a[this.i]||(a[this.i]={w:null,a:""});var b=a[this.i];b.w=Math.max(b.w||0,this.guts.length);var c=this.e.align||this.e.style.textAlign;c&&(b.a=c)}}):lib.ctblk.extend(),lib.td=lib.th.extend(),lib.txt=lib.inl.extend({initK:function(){this.c=this.e[textContProp].split(/^/gm)},rendK:function(){var a=this.c.join("").replace(/\r/gm,"");return this.p instanceof lib.code||this.p instanceof lib.pre||(a=a.replace(/^\s*([#*])/gm,function(a,b){return a.replace(b,"\\"+b)})),0==this.i&&(a=a.replace(/^\n+/,"")),this.i==this.p.c.length-1&&(a=a.replace(/\n+$/,"")),a.replace(/\u00a0/gm,cfg.nbsp_spc?" ":"&nbsp;")}}),lib.rawhtml=lib.blk.extend({initK:function(){this.guts=outerHTML(this.e)},rendK:function(){return this.guts}});for(var i in cfg.unsup_tags)cfg.unsup_tags[i]=new RegExp("^(?:"+("inline"==i?"a|em|strong|img|code|del|":"")+cfg.unsup_tags[i].replace(/\s/g,"|")+")$")},!function(a,b,c){"function"==typeof define?define(c):"undefined"!=typeof module?module.exports=c():b[a]=c()}("klass",this,function(){function a(a){return e.call(b(a)?a:function(){},a,1)}function b(a){return typeof a===f}function c(a,b,c){return function(){var d=this.supr;this.supr=c[h][a];var e={}.fabricatedUndefined,f=e;try{f=b.apply(this,arguments)}finally{this.supr=d}return f}}function d(a,d,e){for(var f in d)d.hasOwnProperty(f)&&(a[f]=b(d[f])&&b(e[h][f])&&g.test(d[f])?c(f,d[f],e):d[f])}function e(a,c){function e(){}function f(){this.init?this.init.apply(this,arguments):(c||j&&g.apply(this,arguments),k.apply(this,arguments))}e[h]=this[h];var g=this,i=new e,j=b(a),k=j?a:this,l=j?{}:a;return f.methods=function(a){return d(i,a,g),f[h]=i,this},f.methods.call(f,l).prototype.constructor=f,f.extend=arguments.callee,f[h].implement=f.statics=function(a,b){return a="string"==typeof a?function(){var c={};return c[a]=b,c}():a,d(this,a,g),this},f}var f="function",g=/xyz/.test(function(){xyz})?/\bsupr\b/:/.*/,h="prototype";return a});